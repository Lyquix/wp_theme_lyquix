//
// blocks.scss - Common rules for blocks
//
// @version     3.0.0
// @package     wp_theme_lyquix
// @author      Lyquix
// @copyright   Copyright (C) 2015 - 2018 Lyquix
// @license     GNU General Public License version 2 or later
// @link        https://github.com/Lyquix/wp_theme_lyquix
//

//    .d8888b. 88888888888 .d88888b.  8888888b.   888
//   d88P  Y88b    888    d88P" "Y88b 888   Y88b  888
//   Y88b.         888    888     888 888    888  888
//    "Y888b.      888    888     888 888   d88P  888
//       "Y88b.    888    888     888 8888888P"   888
//         "888    888    888     888 888         Y8P
//   Y88b  d88P    888    Y88b. .d88P 888          "
//    "Y8888P"     888     "Y88888P"  888         888

//  DO NOT MODIFY THIS FILE!

@function blk-class-name($pre, $num, $den, $scr) {
	$blk-class: $pre;

	@if $den == '' {
		$blk-class: $blk-class + $num + '\\%';
	}
	@else {
		$blk-class: $blk-class + $num + '\\/' + $den;
	}

	@if $scr != '' {
		$blk-class: $blk-class + '-' + $scr;
	}

	@return $blk-class;
}

@function concat-class-names($curr, $new) {
	@if $curr == '' {
		$curr: $new;
	} @else {
		$curr: $new + ', ' + $curr;
	}

	@return $curr;
}

// Count number of percentage steps
$blk-pct-step-count: floor(calc(100 / $blk-pct-step));

@mixin blk-margin-border-padding($i) {
	margin: nth($blk-margin-top-bottom, $i) nth($blk-margin-left-right, $i);
	border-width: nth($blk-border-top-bottom, $i) nth($blk-border-left-right, $i);
	padding: nth($blk-padding-top-bottom, $i) nth($blk-padding-left-right, $i);
}

$blk-display-block: '';

// Fraction classes - display block
@for $d from 1 through $blk-denominator {
	@for $n from 1 through $d {
		$blk-display-block: concat-class-names($blk-display-block, blk-class-name('.blk', $n, $d, ''));
	}
}

// Percentage classes - display block
@for $p from 1 through $blk-pct-step-count {
	$blk-display-block: concat-class-names($blk-display-block, blk-class-name('.blk', $p * $blk-pct-step, '', ''));
}

// display block per screen size
@each $screen-name, $value in $breakpoints {
	@for $d from 1 through $blk-denominator {
		@for $n from 1 through $d {
			$blk-display-block: concat-class-names($blk-display-block, blk-class-name('.blk', $n, $d, $screen-name));
		}
	}

	// Percentage classes - display
	@for $p from 1 through $blk-pct-step-count {
		$blk-display-block: concat-class-names($blk-display-block, blk-class-name('.blk', $p * $blk-pct-step, '', $screen-name));
	}
}

#{$blk-display-block} {
	display: block;
}

$blk-display-flex: '';

// Fraction classes - display flex
@for $d from 1 through $blk-denominator {
	@for $n from 1 through $d {
		$blk-display-flex: concat-class-names($blk-display-flex, blk-class-name('.flex-container.blk', $n, $d, ''));
	}
}

// Percentage classes - display flex
@for $p from 1 through $blk-pct-step-count {
	$blk-display-flex: concat-class-names($blk-display-flex, blk-class-name('.flex-container.blk', $p * $blk-pct-step, '', ''));
}

// display flex per screen size
@each $screen-name, $value in $breakpoints {
	@for $d from 1 through $blk-denominator {
		@for $n from 1 through $d {
			$blk-display-flex: concat-class-names($blk-display-flex, blk-class-name('.flex-container.blk', $n, $d, $screen-name));
		}
	}

	// Percentage classes - display
	@for $p from 1 through $blk-pct-step-count {
		$blk-display-flex: concat-class-names($blk-display-flex, blk-class-name('.flex-container.blk', $p * $blk-pct-step, '', $screen-name));
	}
}

#{$blk-display-flex} {
	display: flex;
}


// blk classes per screen size
@each $screen-name, $value in $breakpoints {
	$i: index(map-keys($breakpoints), $screen-name);

	@include screen($screen-name) {
		$blk-classes: '';

		// Left-right margin to be substracted from width
		$m: #{nth($blk-margin-left-right, $i) * 2};

		// Cycle through all $n/$d fractions
		@for $d from 1 through $blk-denominator {
			@for $n from 1 through $d {
				// Set width and margin, border, padding for fraction and fraction-screen classes
				$pc: percentage(calc($n / $d));

				#{blk-class-name('.blk', $n, $d, '')} {
					width: calc(#{$pc} - #{$m});
				}

				$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk', $n, $d, ''));
			}
		}

		// Cycle through all percent steps
		@for $p from 1 through $blk-pct-step-count {
			// Set width and margin, border, padding for percentage and percentage-screen classes
			$pc: percentage(calc($p * $blk-pct-step / 100));

			#{blk-class-name('.blk', $p * $blk-pct-step, '', '')} {
				width: calc(#{$pc} - #{$m});
			}

			$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk', $p * $blk-pct-step, '', ''));
		}

		#{$blk-classes} {
			@include blk-margin-border-padding($i);
		}
	}
}

// blk-screen specific classes by screen size
@each $screen-name, $value in $breakpoints {
	$i: index(map-keys($breakpoints), $screen-name);

	@include screen($screen-name) {
		$blk-classes: '';

		// Left-right margin to be substracted from width
		$m: #{nth($blk-margin-left-right, $i) * 2};

		// Cycle through all $n/$d fractions
		@for $d from 1 through $blk-denominator {
			@for $n from 1 through $d {
				// Set width and margin, border, padding for fraction and fraction-screen classes
				$pc: percentage(calc($n / $d));

				#{blk-class-name('.blk', $n, $d, '')}-#{$screen-name} {
					width: calc(#{$pc} - #{$m});
				}

				$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk', $n, $d, $screen-name));
			}
		}

		// Cycle through all percent steps
		@for $p from 1 through $blk-pct-step-count {
			// Set width and margin, border, padding for percentage and percentage-screen classes
			$pc: percentage(calc($p * $blk-pct-step / 100));

			#{blk-class-name('.blk', $p * $blk-pct-step, '', '')}-#{$screen-name} {
				width: calc(#{$pc} - #{$m});
			}

			$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk', $p * $blk-pct-step, '', $screen-name));
		}

		#{$blk-classes} {
			@include blk-margin-border-padding($i);
		}
	}
}

// Bleed to margin
$bleed-types: margin border padding;

@mixin blk-bleed-margin {
	margin: 0;
	border-width: 0;
	padding: 0;
}

@mixin blk-bleed-border {
	border-width: 0;
	padding: 0;
}

@mixin blk-bleed-padding {
	padding: 0;
}

@each $bleed-type in $bleed-types {
	// bleed-x classes
	$blk-classes: '';

	@for $d from 1 through $blk-denominator {
		@for $n from 1 through $d {
			@if $bleed-type == 'margin' {
				$pc: percentage(calc($n / $d));
				#{blk-class-name('.blk-bleed-margin.blk', $n, $d, '')} {
					width: #{$pc};
				}
			}

			$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk-bleed-' + $bleed-type + '.blk', $n, $d, ''));
		}
	}

	@for $p from 1 through $blk-pct-step-count {
		@if $bleed-type == 'margin' {
			$pc: percentage(calc($p * $blk-pct-step / 100));
			#{blk-class-name('.blk-bleed-margin.blk', $p * $blk-pct-step, '', '')} {
				width: #{$pc};
			}
		}

		$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk-bleed-' + $bleed-type + '.blk', $p * $blk-pct-step, '', ''));
	}

	#{$blk-classes} {
		@if $bleed-type == margin {
			@include blk-bleed-margin;
		} @else if $bleed-type == border {
			@include blk-bleed-border;
		} @else if $bleed-type == padding {
			@include blk-bleed-padding;
		}
	}

	// bleed-x classes per screen size
	@each $screen-name, $value in $breakpoints {
		@include screen($screen-name) {
			$blk-classes: '';

			@for $d from 1 through $blk-denominator {
				@for $n from 1 through $d {
					@if $bleed-type == 'margin' {
						$pc: percentage(calc($n / $d));
						#{blk-class-name('.blk-bleed-margin.blk', $n, $d, $screen-name)} {
							width: #{$pc};
						}
					}

					$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk-bleed-' + $bleed-type + '.blk', $n, $d, $screen-name));
				}
			}

			@for $p from 1 through $blk-pct-step-count {
				@if $bleed-type == 'margin' {
					$pc: percentage(calc($p * $blk-pct-step / 100));
					#{blk-class-name('.blk-bleed-margin.blk', $p * $blk-pct-step, '', $screen-name)} {
						width: #{$pc};
					}
				}

				$blk-classes: concat-class-names($blk-classes, blk-class-name('.blk-bleed-' + $bleed-type + '.blk', $p * $blk-pct-step, '', $screen-name));
			}

			#{$blk-classes} {
				@if $bleed-type == margin {
					@include blk-bleed-margin;
				} @else if $bleed-type == border {
					@include blk-bleed-border;
				} @else if $bleed-type == padding {
					@include blk-bleed-padding;
				}
			}
		}
	}
}

// blkpush
@each $screen-name, $value in $breakpoints {
	$i: index(map-keys($breakpoints), $screen-name);

	// Left-right Margin
	$m: nth($blk-margin-left-right, $i);

	@include screen($screen-name) {
		@for $d from 1 through $blk-denominator {
			@for $n from 1 through $d {
				// Set Margin
				$pc: percentage(calc($n / $d));

				#{blk-class-name('.blk-push-left', $n, $d, '')} {
					margin-left: calc(#{$pc} + #{$m});
				}

				#{blk-class-name('.blk-push-left', $n, $d, '')} {
					margin-right: calc(#{$pc} + #{$m});
				}
			}
		}

		// Cycle through all percent steps
		@for $p from 1 through $blk-pct-step-count {
			// Set Margin
			$pc: percentage(calc($p * $blk-pct-step / 100));

			#{blk-class-name('.blk-push-left', $p * $blk-pct-step, '', '')} {
				margin-left: calc(#{$pc} + #{$m});
			}

			#{blk-class-name('.blk-push-right', $p * $blk-pct-step, '', '')} {
				margin-right: calc(#{$pc} + #{$m});
			}
		}
	}
}

// blkpush - screen specific
@each $screen-name, $value in $breakpoints {
	$i: index(map-keys($breakpoints), $screen-name);

	// Left-right Margin
	$m: nth($blk-margin-left-right, $i);

	@include screen($screen-name) {
		@for $d from 1 through $blk-denominator {
			@for $n from 1 through $d {
				// Set Margin
				$pc: percentage(calc($n / $d));

				#{blk-class-name('.blk-push-left', $n, $d, $screen-name)} {
					margin-left: calc(#{$pc} + #{$m});
				}

				#{blk-class-name('.blk-push-left', $n, $d, $screen-name)} {
					margin-right: calc(#{$pc} + #{$m});
				}
			}
		}

		// Cycle through all percent steps
		@for $p from 1 through $blk-pct-step-count {
			// Set Margin
			$pc: percentage(calc($p * $blk-pct-step / 100));

			#{blk-class-name('.blk-push-left', $p * $blk-pct-step, '', $screen-name)} {
				margin-left: calc(#{$pc} + #{$m});
			}

			#{blk-class-name('.blk-push-right', $p * $blk-pct-step, '', $screen-name)} {
				margin-right: calc(#{$pc} + #{$m});
			}
		}
	}
}
